(("undefined"!==typeof self?self:this)["webpackJsonpmylittlePressingCreneaux"]=("undefined"!==typeof self?self:this)["webpackJsonpmylittlePressingCreneaux"]||[]).push([[2],{5219:function(e,t,o){},ad69:function(e,t,o){"use strict";o("5219")},bc7a:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("mapgoogle",{ref:"mapgoogle",attrs:{configs:e.configs}})},n=[],a=o("5530"),s=o("8bbf"),l=o.n(s),r=o("b787");l.a.use(r["a"]);var c=new r["a"].Store({state:{configs:{type_filtre:{value:"polygon_box",options:[{text:"Limité uniquement avec le polygon ",value:"polygon"},{text:"Limité avec le polygon et les villes ",value:"polygon_ville"},{text:"Polygon avec les B.P.",value:"polygon_box"}]},input_placeholder:{value:"Saisissez votre adresse"},input_text_button:{value:"Je commande !"},titre_map:{value:"Merci de confirmer votre adresse."},redirect_true:{value:"/pages/tarifs"},redirect_false:{value:"/pages/map-error"},zone_valide:{value:'{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"type":"Polygon","coordinates":[[[4.841194152832031,45.80367454985437],[4.836902618408202,45.810016615545685],[4.840335845947266,45.81564010746663],[4.836387634277343,45.82257895307966],[4.824542999267578,45.82413409295147],[4.826087951660156,45.83083266040038],[4.813385009765625,45.82939732095006],[4.807720184326172,45.832626782661535],[4.801025390625,45.84673852742612],[4.784889221191406,45.843151135002806],[4.774417877197266,45.84960827480199],[4.766349792480469,45.84924956447676],[4.748497009277344,45.87758055276022],[4.743690490722656,45.876743979429186],[4.731502532958984,45.850923526202244],[4.7218894958496085,45.850325688512264],[4.718799591064453,45.86789943388497],[4.719829559326172,45.87327804145782],[4.6973419189453125,45.861563961888706],[4.695110321044921,45.85833617968687],[4.687385559082031,45.86766037257888],[4.674167633056641,45.86658458397811],[4.667987823486328,45.857379763789915],[4.672794342041016,45.854749535250534],[4.668674468994141,45.84960827480199],[4.674510955810547,45.83944391979866],[4.666786193847656,45.82724424237223],[4.636402130126953,45.82257895307966],[4.632282257080078,45.81480260210369],[4.635715484619141,45.8051105524909],[4.656314849853516,45.79745144402688],[4.6561431884765625,45.7897912826699],[4.682750701904297,45.790150376254054],[4.679145812988281,45.77099548979183],[4.695453643798828,45.757343618424514],[4.709358215332031,45.759140108157524],[4.7138214111328125,45.7578226880087],[4.707298278808593,45.749079020680476],[4.710731506347656,45.73482270844982],[4.7261810302734375,45.73685954736049],[4.724636077880859,45.73398398848103],[4.7330474853515625,45.722240586293125],[4.772014617919922,45.72703410987784],[4.778537750244141,45.722240586293125],[4.803943634033203,45.722000899316875],[4.8125267028808585,45.74596450695352],[4.8168182373046875,45.748000939440544],[4.814414978027344,45.74488636556012],[4.812355041503906,45.73937553991511],[4.813899993896484,45.73518215600897],[4.814586639404297,45.7321866889887],[4.817333221435547,45.72931088949232],[4.818019866943359,45.7269142768011],[4.819908142089844,45.720203214218415],[4.822139739990234,45.716248103400375],[4.824886322021484,45.71313175830802],[4.831066131591796,45.71097418682745],[4.836387634277343,45.708576787494145],[4.8401641845703125,45.7077376734339],[4.840507507324219,45.71660767049757],[4.849262237548828,45.71828561969278],[4.854412078857421,45.719124575395526],[4.857501983642578,45.72799276523713],[4.882221221923827,45.721042141129054],[4.888401031494141,45.72355884628182],[4.8896026611328125,45.7271539426975],[4.893207550048828,45.7387765043515],[4.898700714111328,45.751953802189036],[4.917411804199219,45.74740199642105],[4.922904968261719,45.761774855141226],[4.904365539550781,45.773031008933344],[4.906082153320312,45.78380604900099],[4.882049560546875,45.7897912826699],[4.879302978515624,45.79565618817645],[4.872608184814453,45.7896715842944],[4.865398406982422,45.787277562802686],[4.855442047119141,45.787157859029],[4.852867126464844,45.78643963098876],[4.849605560302734,45.785362271577036],[4.846515655517578,45.783207490288774],[4.843769073486328,45.780573755608906],[4.8415374755859375,45.779137120616426],[4.824886322021484,45.785003147146114],[4.821624755859375,45.79146703293602],[4.825572967529297,45.794579006904314],[4.829349517822266,45.7964939814375],[4.838447570800781,45.79984502852525],[4.841194152832031,45.80367454985437]]]}}]}'},villes:{value:"Lyon; Tassin-la-demi-Lune; Ecully; Champagne au Mont d'Or; Saint-Didier-au-Mont-d'Or; Charbonnières-les-Bains; Marcy-l'Etoile; Dardilly; Limonest; Dommartin; La Tour-de-Salvagny; Lentilly; Sainte Foy-Lès-Lyon; Francheville; Saint-Genis-les-Ollières; Sainte-Consorce; Lozanne; Civrieux-d'Azergues; Lissieu; Saint-Cyr-au-Mont-d'Or;"},bps:{value:"69005\n69009\n69160\n69130\n69410\n69370\n69260\n69280\n69570\n69760\n69380\n69890\n69210\n69110\n69340\n69290\n69280\n69380\n69380\n69380\n69450\n69001\n69002\n69003\n69004\n69006\n69007\n69008\n69100"},mapConfig:{apiKey:"AIzaSyDurloZ0-xj8CNrQwkeSc53A-_n35Xji2Y",libraries:["places","geometry"]}}},mutations:{},actions:{},modules:{}}),p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("section",{staticClass:"modal micromodal-slide",attrs:{id:"map-popup-wbu"}},[o("div",{staticClass:"modal__overlay"},[o("div",{staticClass:"modal__container",attrs:{role:"dialog","aria-modal":"true","aria-labelledby":"modal-1-title"}},[o("header",{staticClass:"modal__header"},[o("h2",{staticClass:"modal__title",attrs:{id:"modal-1-title"}},[e._v(" "+e._s(e.titre_popup)+" ")]),o("a",{staticClass:"modal__close",attrs:{href:"#",rel:"modal:close"},on:{click:function(t){return e.micromodal.close("map-popup-wbu")}}})]),o("main",{staticClass:"modal__content",attrs:{id:"modal-1-content"}},[o("div",{staticClass:"m-0 p-0 container-map"},[o("div",{attrs:{id:"map-display-wbu"}}),o("div",{staticClass:"text-over-lay"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.current_address,expression:"current_address"}],staticClass:"form-control",attrs:{type:"text",placeholder:e.placeholder,id:"map-input-over"},domProps:{value:e.current_address},on:{input:function(t){t.target.composing||(e.current_address=t.target.value)}}})]),o("div",{staticClass:"center-marker"}),o("div",{staticClass:"address-confirm"},[o("button",{staticClass:"btn btn-lg bg-cl1",on:{click:e.save_localisation_cookie}},[e._v(" Confirmer l'adresse ")])])])])])])])])},d=[],u=(o("4f27"),o("2311"),o("977c"),o("13eb"),o("c10f"),o("dcbb"),o("43c9"),o("0202"),o("39e3"),o("ab51"),o("7eb8"),o("06d1")),m={apiKey:"AIzaSyDurloZ0-xj8CNrQwkeSc53A-_n35Xji2Y",GoogleObejct:null,createGoogleObject:function(){var e=this,t=new u["a"]({apiKey:this.apiKey,version:"weekly",libraries:["places","geometry"]});return new Promise((function(o){t.load().then((function(t){e.GoogleObejct=t,o(t)})).catch((function(e){console.log("Erreur initialisation de la MAP : ",e)}))}))},extractPathForPolygon:function(e){var t=JSON.parse(e),o=[];if(t.features&&t.features[0]&&t.features[0].geometry&&t.features[0].geometry.coordinates)for(var i in t.features[0].geometry.coordinates[0]){var n=t.features[0].geometry.coordinates[0][i];o.push({lat:n[1],lng:n[0]})}return o},convertNewLineToArray:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\n";return e.split(t).map((function(e){return e.trim()}))}},_=o("7563"),g={name:"Mapgoogle",props:{configs:{type:Object,required:!0},display_marker:{type:Boolean,default:!0},image:{type:String,default:"/localisation/img/marker.png"},url_good:{type:String,default:"/cart"},url_bad:{type:String,default:"/pages/map-error"}},data:function(){return{id_html:"map-google-field",villes:m.convertNewLineToArray(this.configs.villes.value,";"),list_box:m.convertNewLineToArray(this.configs.bps.value),micromodal:_["a"],map:null,lat:45.7941459,lon:4.68941940000002,point_in_polygon:!1,point_in_ville:!1,point_in_box:!1,titre_popup:"Merci de confirmer votre adresse",current_address:"",valide_text:"Commander maintenant",placeholder:"Entrez votre adresse"}},mounted:function(){this.point_in_box=!1,this.point_in_polygon=!1,this.point_in_ville=!1,this.createGoogleObject()},methods:{openPopupMap:function(){this.micromodal.show("map-popup-wbu")},closePopupMap:function(){this.micromodal.close("map-popup-wbu")},createGoogleObject:function(){var e=this;m.createGoogleObject().then((function(t){e.GoogleObejct=t,e.getPlace(),e.initMap(),e.geocoder=new e.GoogleObejct.maps.Geocoder}))},getPlace:function(){var e=this,t=document.querySelector("#map-input-over");this.options={componentRestrictions:{country:["fr"]},types:["address"],strictBounds:!0};var o=new this.GoogleObejct.maps.places.Autocomplete(t,this.options);this.GoogleObejct.maps.event.addListener(o,"place_changed",(function(){var t=o.getPlace();t&&t.formatted_address&&(e.current_address=t.formatted_address,e.city_on_map=t.vicinity,e.updateMap(t),e.openPopupMap())}))},initMap:function(){var e=this,t=this.lat,o=this.lon;this.map=new this.GoogleObejct.maps.Map(document.getElementById("map-display-wbu"),{center:new this.GoogleObejct.maps.LatLng(t,o),zoom:17,mapTypeId:this.GoogleObejct.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scrollwheel:!1,mapTypeControlOptions:{style:this.GoogleObejct.maps.MapTypeControlStyle.HORIZONTAL_BAR},navigationControl:!1,panControl:!1,zoomControl:!0,streetViewControl:!1,fullscreenControl:!1,navigationControlOptions:{style:this.GoogleObejct.maps.NavigationControlStyle.ZOOM_PAN},styles:[{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#b8cb92"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#ece2d9"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]}]}),this.setMarker(),this.map.addListener("dragend",(function(){window.setTimeout((function(){var t=e.map.getCenter();t&&(e.lat=t.lat(),e.lon=t.lng(),e.city_on_map="",e.obtenir_address_proche())}),1e3)})),this.buildpolygon(),this.valide_selection()},updateMap:function(e){e.geometry&&(this.map.panTo(e.geometry.location),this.lat=e.geometry.location.lat(),this.lon=e.geometry.location.lng(),this.setMarker(),this.valide_selection())},valide_selection:function(){this.check_if_new_adress_in_polygon(),this.check_if_new_adress_in_villes(),this.check_if_new_adress_in_box()},obtenir_address_proche:function(){var e=this,t=new this.GoogleObejct.maps.LatLng(this.lat,this.lon);this.geocoder.geocode({location:t},(function(t,o){"OK"==o&&(e.current_address=t[0].formatted_address,e.updateMap(t[0]),e.getNameVilleFromPlace(t[0]))}))},setMarker:function(){if(!this.display_marker)return!1;var e=this,t=this.lat,o=this.lon;this.marker=new this.GoogleObejct.maps.Marker({position:{lat:t,lng:o},map:e.map,icon:this.image})},save_localisation_cookie:function(){if(""==this.current_address)return localStorage.removeItem("wbu_localisation_map"),alert("Vous devez definir une adresse"),!1;this.point_in_polygon&&this.point_in_ville&&this.point_in_box?(localStorage.setItem("wbu_localisation_map",JSON.stringify(this.current_address)),localStorage.setItem("wbu_localisation_city",JSON.stringify(this.city_on_map)),localStorage.setItem("wbu_locality",this.locality),localStorage.setItem("wbu_route",this.route),this.etape_checkout?(document.querySelector(".modal__close").click(),this.no_action_after||document.querySelector(".button.cart-checkout-custom").click()):window.location.href=this.url_good):(localStorage.removeItem("wbu_localisation_map"),localStorage.removeItem("wbu_localisation_city"),window.location.href=this.url_bad)},buildpolygon:function(){this.polygon=new this.GoogleObejct.maps.Polygon({path:m.extractPathForPolygon(this.configs.zone_valide.value),geodesic:!0,strokeColor:"#48a0d9",strokeOpacity:.4,strokeWeight:4,fillColor:"#48a0d9",fillOpacity:.03}),this.polygon.setMap(this.map)},check_if_new_adress_in_polygon:function(){var e=new this.GoogleObejct.maps.LatLng(this.lat,this.lon);this.GoogleObejct.maps.geometry.poly.containsLocation(e,this.polygon)?this.point_in_polygon=!0:this.point_in_polygon=!1},check_if_new_adress_in_villes:function(){var e=this,t=function(){var t=!1;if(e.current_address&&e.current_address.length>0){var o=e.current_address.split(",");o[1].length>0&&e.villes.forEach((function(e){o[1].indexOf(e)>=0&&(t=!0)}))}return t};return"polygon_ville"!=this.type_limitation?(this.point_in_ville=!0,!1):this.villes.indexOf(this.city_on_map)>=0||t()?(this.point_in_ville=!0,!0):void(this.point_in_ville=!1)},check_if_new_adress_in_box:function(){var e=this,t=function(){var t=!1;return e.current_address&&e.current_address.length>0&&e.current_address&&e.list_box.forEach((function(o){e.current_address.indexOf(o)>=0&&(t=!0)})),t};return"polygon_box"!=this.type_limitation?(this.point_in_box=!0,!1):t()?(this.point_in_box=!0,!0):(this.point_in_box=!1,!0)},getNameVilleFromPlace:function(e){var t="",o="";if(e.address_components){for(var i in e.address_components){var n=e.address_components[i];n.types&&n.types.includes("locality")&&""==o&&(o=n.long_name),n.types&&n.types.includes("route")&&""==t&&(t=n.long_name)}this.route=t,this.locality=o}}}},h=g,y=o("2877"),f=Object(y["a"])(h,p,d,!1,null,null,null),v=f.exports,b={name:"AppPopUpMap",store:c,components:{mapgoogle:v},computed:Object(a["a"])({},Object(r["b"])(["configs"])),methods:{openModal:function(){this.$refs.mapgoogle.openPopupMap()}}},w=b,O=(o("ad69"),Object(y["a"])(w,i,n,!1,null,"2ef9eade",null));t["default"]=O.exports}}]);
//# sourceMappingURL=mylittlePressingCreneaux.umd.min.2.js.map