(("undefined"!==typeof self?self:this)["webpackJsonpAppAllCreneaux"]=("undefined"!==typeof self?self:this)["webpackJsonpAppAllCreneaux"]||[]).push([[5],{5327:function(e,t,n){},"7d97":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container my-4 app-admin border py-4 px-5"},[n("h3",[e._v("Configuration de l'application")]),n("div",{staticClass:"my-4"},[n("b-tabs",{attrs:{"content-class":"my-3"}},[n("b-tab",{attrs:{title:"Configuration de base",active:""}},[n("CreneauBase",{attrs:{creneau_configs:e.creneau_configs}})],1),n("b-tab",{attrs:{title:"Configuration des creneaux et dates"}},[n("CreneauFilters",{attrs:{filters:e.creneau_filters,"jours-active":e.joursActive}})],1),n("b-tab",{attrs:{title:"Type de livraison"}},[n("TypeLivraison",{attrs:{"creneau-types":e.creneau_types,"jours-active":e.joursActive}})],1)],1),n("div",{staticClass:"d-flex justify-content-end"},[n("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"outline-info"},on:{click:e.ResetConfigTest}},[e._v(" Ré-initialise ")]),n("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"outline-info"},on:{click:e.SaveConfigTestReload}},[e._v(" Voir l'aperçu ")]),n("hr"),n("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"outline-info"},on:{click:e.loadMetafieldConfig}},[e._v(" Charge la config de production ")]),n("b-button",{attrs:{size:"sm",variant:"outline-success"},on:{click:e.SaveMetafieldConfig}},[e._v(" Enregistrer en production ")])],1)],1)])},i=[],r=(n("4de4"),n("4160"),n("d3b7"),n("e6cf"),n("159b"),n("96cf"),n("1da1")),s=n("8bbf"),o=n.n(s),c=n("5f5b"),u=n("b1e0"),l=(n("ac1f"),n("841c"),n("1276"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button",{attrs:{variant:"outline-success",size:"sm"},on:{click:e.onSubmit}},[n("span",[e._v(e._s(e.texte))]),e.running?n("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)}),d=[],f={name:"ButtonSave",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Enregistrer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{onSubmit:function(){this.$emit("ev-click")}}},p=f,v=n("2877"),h=Object(v["a"])(p,l,d,!1,null,"29246a2e",null),m=(h.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:e.DeleteFile}},[n("span",[e._v(" "+e._s(e.texte)+" ")]),e.running?n("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)}),g=[],_={name:"ButtonDelete",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Supprimer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{DeleteFile:function(){this.$emit("ev-click")}}},b=_,y=Object(v["a"])(b,m,g,!1,null,"0b82f270",null),w=(y.exports,n("47d8"),n("c26d"),n("a9ce"),n("9a6c"),n("7973"),n("6b54")),x=n.n(w),C=x.a.create({timeout:15e3}),j={axiosInstance:C,post:function(e,t,n){return new Promise((function(a,i){C.post(e,t,n).then((function(e){a({status:!0,data:e.data,reponse:e})})).catch((function(e){i({status:!1,error:e.response,code:e.code,stack:e.stack})}))}))},get:function(e,t){return new Promise((function(n,a){C.get(e,t).then((function(e){n({status:!0,data:e.data,reponse:e})})).catch((function(e){a({status:!1,error:e.response,code:e.code,stack:e.stack})}))}))},postFile:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(i,r){n.getBase64(t).then((function(n){var s=new Headers;console.log("headers : ",s);var o=t.name.split("."),c={method:"POST",headers:s,body:JSON.stringify({upload:n.base64,filename:o[0],ext:o[1],id:a}),cache:"default"};fetch(e,c).then((function(e){e.json().then((function(e){i(e)})).catch((function(e){r(e)}))}))}))}))},getBase64:function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onloadend=function(){var e=a.result.split(",");t({src:a.result,base64:e[1]})},a.onerror=function(e){return n(e)}}))}},S=j,k=n("5530"),D=n("0ae9");o.a.use(D["a"]);var T=new o.a,O=Object(k["a"])(Object(k["a"])({},S),{},{$bvToast:T.$bvToast,$bvModal:T.$bvModal,modalMessage:function(e,t){var n=this,a={size:"md",buttonSize:"sm",hideFooter:!0,centered:void 0===t.centered||t.centered};for(var i in t)a[i]=t[i];return new Promise((function(t,i){n.$bvModal.msgBoxConfirm(e,a).then((function(e){t(e)})).catch((function(e){i(e)}))}))},modalConfirmDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Confirmer la suppression, NB : cette action est irreverssible.",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:"Attention",okVariant:"danger",okTitle:"Supprimer",cancelTitle:"Annuler",footerClass:"p-2",hideHeaderClose:!1,centered:!0,hideFooter:!0};return this.modalMessage(e,t)},modalSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={title:"Succes",headerBgVariant:"success",bodyClass:["p-3"],hideFooter:!0,headerTextVariant:"light"};for(var a in t)n[a]=t[a];return this.modalMessage(e,n)},notification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";this.$bvToast.toast(" ",{title:e,variant:t,solid:!0,toaster:"b-toaster-top-right"})},post:function(e,t,n){var a=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(r,s){S.post(e,t,n).then((function(e){i&&a.notification("success"),r(e)})).catch((function(e){a.notification(a.GetErrorTitle(e),"warning"),s(e)}))}))},get:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i,r){S.post(e,t).then((function(e){a&&n.notification("success"),i(e)})).catch((function(e){n.notification(n.GetErrorTitle(e),"warning"),r(e)}))}))},GetErrorTitle:function(e){var t;if(e.code)switch(e.code){case"ECONNABORTED":var n=this.axiosInstance.defaults.timeout/1e3+"s";t="Impossible de joindre l'hote distant, temps impartie epuisé. ("+n+")";break;default:t="Une erreur s'est produite"}else e.error&&e.error.statusText&&(t=decodeURI(e.error.statusText));return t}}),R=O,M={ModeDebug:!0,post:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a){var i={headers:{}};R.post(e+"?"+t.GetQuery(),n,i).then((function(e){console.log("Config success : ",e),a({status:!0,data:e.data,reponse:e})})).catch((function(e){a({status:!1,error:e.response})}))}))},saveMetaFields:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wbu_creneaux",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/admin/metafields.json",a=[];e.forEach((function(e){a.push({namespace:t,key:e.key,value:e.value,value_type:e.value_type})})),this.post("/app/creneaux/shopify/request/SaveMetafields",{endPoint:n,metafields:a})},get:function(e){return console.log("ssss"),new Promise((function(t){var n={headers:{}};R.get(e,n).then((function(e){console.log("Config get success : ",e),t({status:!0,data:e.data,reponse:e})})).catch((function(e){t({status:!1,error:e.response})}))}))},GetQuery:function(){var e=window.location.search,t=e.split("?");return t[1]?t[1]:""},SaveConfigsTest:function(e){return R.post("/creneaux-shopify/test-config?"+this.GetQuery(),e)}},F=n("92c3");o.a.use(c["a"]),o.a.use(u["a"]);var B={name:"Admin",props:{},components:{CreneauBase:function(){return n.e(8).then(n.bind(null,"4288"))},CreneauFilters:function(){return n.e(6).then(n.bind(null,"188e"))},TypeLivraison:function(){return n.e(7).then(n.bind(null,"4216"))}},data:function(){return{creneau_configs:{},creneau_filters:[],creneau_types:{}}},mounted:function(){this.LoadValues()},watch:{},computed:{joursActive:function(){var e=[];if(this.creneau_configs.days)for(var t in this.creneau_configs.days)this.creneau_configs.days[t].value&&e.push(this.creneau_configs.days[t]);return e}},methods:{resetDatas:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.creneau_configs=F["a"].DefaultCreneauConfigs(),e.creneau_filters=[F["a"].filter()],e.creneau_types=F["a"].DefaultCreneauTypes();case 3:case"end":return t.stop()}}),t)})))()},BuildDays:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.creneau_configs.days&&0==e.creneau_configs.days.length&&F["a"].JourInfos().forEach((function(t){e.creneau_configs.days.push(t)}));case 1:case"end":return t.stop()}}),t)})))()},SaveMetafieldConfig:function(){M.saveMetaFields([{key:"creneau_configs",value:this.creneau_configs,value_type:"json_string"},{key:"creneau_filters",value:this.creneau_filters,value_type:"json_string"},{key:"creneau_types",value:this.creneau_types,value_type:"json_string"}])},SaveConfigTestReload:function(){"localhost:8080"===window.location.host&&"undefined"!==typeof localStorage?(localStorage.setItem("creneau_configs",JSON.stringify(this.creneau_configs)),localStorage.setItem("creneau_filters",JSON.stringify(this.creneau_filters)),localStorage.setItem("creneau_types",JSON.stringify(this.creneau_types)),window.location.reload()):M.SaveConfigsTest({creneau_configs:this.creneau_configs,creneau_filters:this.creneau_filters,creneau_types:this.creneau_types}).then((function(){window.location.reload()}))},ResetConfigTest:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"localhost:8080"===window.location.host&&"undefined"!==typeof localStorage&&(localStorage.removeItem("creneau_configs"),localStorage.removeItem("creneau_filters"),localStorage.removeItem("creneau_types")),t.next=3,e.resetDatas();case 3:return t.next=5,e.loadDefaultDatas();case 5:e.SaveConfigTestReload();case 6:case"end":return t.stop()}}),t)})))()},loadMetafieldConfig:function(){var e=this;M.post("/app/creneaux/shopify/request/LoadMetafields",{endPoint:"/admin/metafields.json"}).then((function(t){var n=!1;if(t.status&&t.data.metafields)for(var a in t.data.metafields){var i=t.data.metafields[a];if("wbu_creneaux"===i.namespace)switch(n=!0,i.key){case"creneau_configs":e.creneau_configs=JSON.parse(i.value);break;case"creneau_filters":e.creneau_filters=JSON.parse(i.value);break;case"creneau_types":e.creneau_types=JSON.parse(i.value);break}var r=parseInt(a)+1;r!==t.data.metafields.length||n||e.LoadValues()}else e.LoadValues()}))},LoadValues:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!1,a=window.creneau_configs,a&&a.days&&(e.creneau_configs=a,n=!0),i=window.creneau_types,i&&i.typelivraison&&(e.creneau_types=i),r=window.creneau_filters,r&&r.length&&(e.creneau_filters=r),n){t.next=10;break}return t.next=10,e.resetDatas();case 10:e.loadDefaultDatas();case 11:case"end":return t.stop()}}),t)})))()},loadDefaultDatas:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.BuildDays();case 2:case"end":return t.stop()}}),t)})))()}}},E=B,I=(n("cbd1"),Object(v["a"])(E,a,i,!1,null,null,null));t["default"]=I.exports},"92c3":function(e,t,n){"use strict";n("4160"),n("159b");var a={JourInfos:function(){return[{text:"Lundi",value:1,debut:"7:30",fin:"21:30",indice:1},{text:"Mardi",value:1,debut:"7:30",fin:"21:30",indice:2},{text:"Mercredi",value:1,debut:"7:30",fin:"21:30",indice:3},{text:"Jeudi",value:1,debut:"7:30",fin:"21:30",indice:4},{text:"Vendredi",value:1,debut:"7:30",fin:"21:30",indice:5},{text:"Samedi",value:1,debut:"7:30",fin:"21:30",indice:6},{text:"Dimanche",value:0,debut:"7:30",fin:"21:30",indice:0}]},DefaultCreneauConfigs:function(){return{days:[],nombre_semaine:5,nombre_res_creneau:2,title:"Finaliser la commande",deccalage_creneau_depart:0}},DefaultCreneauTypes:function(){return{typelivraison:this.getDefaultTypeLivraion()}},filter:function(){return{titre:"Indisponibilité, congé",h_debut:"",h_fin:"",jour_type:"",show_select_date_indice_all:null,select_jour_indice:"",jourmode:"manuel",jours_select:[],date_desactivee:[],periode_desactivee:[]}},GetUniqueDays:function(){var e=[];return this.jours_selects.forEach((function(t){"all"!==t.value&&e.push(t)})),e},getDefaultDelaiOverride:function(){return{day:"",delai:4}},getDefaultTypeLivraion:function(){return[{titre:"Gratuit",body:'<div class="d-flex justify-content-between"> <span>Créneau horaire de {{ creneau }} min </span> <span>Délai de traitement de {{ delai }} Jours </span> </div>',montant_libele:"Frais de livraison : {{montant}}",montant:"Gratuit",type:"free",creneau:120,delai_next_creneau:30,delai:3,delais_jour:[],id:32583132807228,active:!0},{titre:"Plus",body:'<div class="d-flex justify-content-between"> <span>Créneau horaire de {{ creneau }} min </span> <span>Délai de traitement de {{ delai }} jours </span> </div>',montant_libele:"Frais de livraison : {{montant}}€",montant:"9.99",type:"plus",creneau:60,delai_next_creneau:30,delai:2,delais_jour:[],id:32583132839996,active:!1},{titre:"Express",body:'<div class="d-flex justify-content-between"> <span>Créneau horaire de {{ creneau }} min </span> <span>Délai de traitement de {{ delai }} jours </span> </div>',montant_libele:"Frais de livraison : {{montant}}€",montant:"19.99",type:"express",creneau:30,delai_next_creneau:30,delai:1,delais_jour:[],id:32583132872764,active:!1}]}};t["a"]=a},cbd1:function(e,t,n){"use strict";n("5327")}}]);
//# sourceMappingURL=AppAllCreneaux.umd.min.5.js.map